<m-portlet [loading$]="viewControl.loading$"
    [options]="{class: ['m-portlet--body-progress', 'm-portlet--body-progress-overlay']}">

    <ng-container mPortletHeadTitle>

        <a routerLink="/jobs" class="btn btn-secondary m-btn m-btn--icon text-uppercase">
            <span>
                <i class="fa fa-arrow-left"></i>
                <span translate="COMMON.BACK"></span>
            </span>
        </a>

    </ng-container>

    <ng-container mPortletHeadTools>

        <div class="m-buttons--wrapper">

            <button type="button" class="btn btn-success m-btn m-btn--icon text-uppercase" (click)="save()">
                <span>
                    <i class="fa fa-save"></i>
                    <span translate="COMMON.SAVE"></span>
                </span>
            </button>

        </div>

    </ng-container>

    <ng-container mPortletBody>

        <form class="m-form" id="m_form" [formGroup]="form">

            <div class="row">

                <div class="col-lg-8 col-xl-8">

                    <div class="form-group m-form__group row">

                        <div class="col-xl-12 col-lg-12">

                            <m-portlet [options]="{theme: 'm-portlet--theme-gray-header'}">

                                <ng-container mPortletHeadTitle>

                                    <div class="m-portlet__head-title">
                                        <h3 class="m-portlet__head-text">
                                            <span>
                                                {{ 'JOBS.BASIC_INFO' | translate }}
                                            </span>
                                        </h3>
                                    </div>

                                </ng-container>

                                <ng-container mPortletBody>

                                    <div class="m-form__section m-form__section--first">

                                        <div class="form-group m-form__group row">

                                            <div class="col-xl-6 col-lg-6">

                                                <mat-form-field class="mat-form-field-fluid">

                                                    <mat-label>
                                                        <span translate="FORM.FIELDS.TITLE"></span>
                                                    </mat-label>

                                                    <input type="text" matInput formControlName="Title" />

                                                    <mat-error
                                                        *ngIf="form.get('Title').invalid && form.get('Title').touched">
                                                        <m-error-parser [ngControl]="form.get('Title')">
                                                        </m-error-parser>
                                                    </mat-error>

                                                </mat-form-field>

                                            </div>

                                            <div class="col-xl-6 col-lg-6">

                                                <mat-form-field class="mat-form-field-fluid">

                                                    <mat-label>
                                                        <span translate="FORM.FIELDS.DEMANDS"></span>
                                                    </mat-label>

                                                    <input matInput type="number" step="1" min="0" max="100"
                                                        formControlName="Demands">

                                                    <mat-error
                                                        *ngIf="form.get('Demands').invalid && form.get('Demands').touched">
                                                        <m-error-parser [ngControl]="form.get('Demands')">
                                                        </m-error-parser>
                                                    </mat-error>

                                                </mat-form-field>

                                            </div>

                                        </div>

                                        <div class="form-group m-form__group row">

                                            <div class="col-xl-6 col-lg-6">

                                                <m-tags [autoComplete]="true" [addInAutoComplete]="true" [max]="1"
                                                    [data]="viewData.recruitments" formControlName="Recruitment">

                                                    <ng-container mTagsLabel>
                                                        <span translate="FORM.FIELDS.RECRUITMENT"></span>
                                                    </ng-container>

                                                    <ng-container mTagsError
                                                        *ngIf="form.get('Recruitment').invalid && form.get('Recruitment').touched">
                                                        <m-error-parser [ngControl]="form.get('Recruitment')">
                                                        </m-error-parser>
                                                    </ng-container>

                                                    <ng-container mTagsHint>
                                                        <span translate="JOBS.HINTS.INPUT_RECRUITMENT"></span>
                                                    </ng-container>

                                                </m-tags>

                                            </div>

                                            <div class="col-xl-6 col-lg-6">

                                                <mat-form-field class="mat-form-field-fluid">
                                                    <mat-label>
                                                        <span translate="FORM.FIELDS.JOB_TITLES"></span>
                                                    </mat-label>

                                                    <mat-select formControlName="JobTitles" multiple>

                                                        <mat-option *ngFor="let item of viewData.jobTitles"
                                                            [value]="item.Id">

                                                            {{ item.Title }}

                                                        </mat-option>

                                                    </mat-select>

                                                    <mat-error
                                                        *ngIf="form.get('JobTitles').invalid && form.get('JobTitles').touched">
                                                        <m-error-parser [ngControl]="form.get('JobTitles')">
                                                        </m-error-parser>
                                                    </mat-error>

                                                </mat-form-field>

                                            </div>

                                        </div>

                                        <div class="form-group m-form__group row">

                                            <div class="col-xl-12 col-lg-12">

                                                <m-tags [autoComplete]="true" [addInAutoComplete]="true"
                                                    [data]="viewData.jobTypes" formControlName="JobTypes">

                                                    <ng-container mTagsLabel>
                                                        <span translate="FORM.FIELDS.JOB_TYPE"></span>
                                                    </ng-container>

                                                    <ng-container mTagsError
                                                        *ngIf="form.get('JobTypes').invalid && form.get('JobTypes').touched">
                                                        <m-error-parser [ngControl]="form.get('JobTypes')">
                                                        </m-error-parser>
                                                    </ng-container>

                                                </m-tags>

                                            </div>

                                        </div>

                                    </div>

                                    <div class="m-separator m-separator--dashed m-separator--sm"></div>

                                    <div class="m-form__section">

                                        <div class="form-group m-form__group row">

                                            <div class="col-xl-12 col-lg-12">

                                                <mat-form-field class="mat-form-field-fluid">

                                                    <mat-label>
                                                        <span translate="FORM.FIELDS.DESCRIPTION"> </span>
                                                    </mat-label>

                                                    <textarea matInput cdkTextareaAutosize cdkAutosizeMinRows="2"
                                                        formControlName="Description"></textarea>

                                                    <mat-error
                                                        *ngIf="form.get('Description').invalid && form.get('Description').touched">
                                                        <m-error-parser [ngControl]="form.get('Description')">
                                                        </m-error-parser>
                                                    </mat-error>

                                                </mat-form-field>

                                            </div>

                                        </div>

                                        <div class="form-group m-form__group row">

                                            <div class="col-xl-12 col-lg-12">

                                                <mat-form-field class="mat-form-field-fluid">

                                                    <mat-label>
                                                        <span translate="FORM.FIELDS.REQUIREMENTS"></span>
                                                    </mat-label>

                                                    <textarea matInput cdkTextareaAutosize cdkAutosizeMinRows="2"
                                                        formControlName="Requirements"></textarea>

                                                    <mat-error
                                                        *ngIf="form.get('Requirements').invalid && form.get('Requirements').touched">
                                                        <m-error-parser [ngControl]="form.get('Requirements')">
                                                        </m-error-parser>
                                                    </mat-error>

                                                </mat-form-field>

                                            </div>

                                        </div>

                                        <div class="form-group m-form__group row">

                                            <div class="col-xl-12 col-lg-12">

                                                <mat-form-field class="mat-form-field-fluid">

                                                    <mat-label>
                                                        <span translate="FORM.FIELDS.WORKING_ADDRESS"></span>
                                                        &nbsp;(<span translate="FORM.FIELDS.OPTIONAL"></span>)
                                                    </mat-label>

                                                    <input type="text" matInput formControlName="WorkingAddress" />

                                                    <mat-hint align="start">
                                                        {{ 'JOBS.HINTS.WORKING_ADDRESS_EMPTY' | translate }}
                                                    </mat-hint>

                                                </mat-form-field>

                                            </div>

                                        </div>

                                        <div class="form-group m-form__group row">

                                            <div class="col-xl-6  col-lg-6">

                                                <mat-form-field class="mat-form-field-fluid">

                                                    <mat-label>
                                                        <span translate="FORM.FIELDS.SALARY"> </span>
                                                    </mat-label>

                                                    <input type="text" matInput formControlName="Salary" />

                                                    <mat-error
                                                        *ngIf="form.get('Salary').invalid && form.get('Salary').touched">
                                                        <m-error-parser [ngControl]="form.get('Salary')">
                                                        </m-error-parser>
                                                    </mat-error>

                                                </mat-form-field>

                                            </div>

                                            <div class="col-xl-6 col-lg-6">

                                                <mat-form-field class="mat-form-field-fluid">

                                                    <mat-label>
                                                        {{ 'FORM.FIELDS.DATE_RANGE' | translate }}
                                                    </mat-label>

                                                    <input type="text" matInput readonly ngxDaterangepickerMd
                                                        formControlName="DateRanges" [showDropdowns]="true"
                                                        [autoApply]="true" [locale]="locale" [drops]="'up'" />

                                                    <mat-error
                                                        *ngIf="form.get('DateRanges').invalid && form.get('DateRanges').touched">
                                                        <m-error-parser [ngControl]="form.get('DateRanges')">
                                                        </m-error-parser>
                                                    </mat-error>

                                                </mat-form-field>

                                            </div>

                                        </div>

                                        <div class="form-group m-form__group row">

                                            <div class="col-xl-6 col-lg-6">

                                                <m-tags [autoComplete]="true" [addInAutoComplete]="true"
                                                    [data]="viewData.jobBenefits" formControlName="JobBenefits">

                                                    <ng-container mTagsLabel>
                                                        <span translate="FORM.FIELDS.JOB_BENEFITS"> </span>
                                                    </ng-container>

                                                    <ng-container mTagsError
                                                        *ngIf="form.get('JobBenefits').invalid && form.get('JobBenefits').touched">
                                                        <m-error-parser [ngControl]="form.get('JobBenefits')">
                                                        </m-error-parser>
                                                    </ng-container>

                                                </m-tags>

                                            </div>

                                            <div class="col-xl-6 col-lg-6">

                                                <mat-form-field class="mat-form-field-fluid">

                                                    <mat-label>
                                                        <span translate="FORM.FIELDS.REQUIRED_FIELD"></span>
                                                        &nbsp;(<span translate="FORM.FIELDS.OPTIONAL"></span>)
                                                    </mat-label>

                                                    <mat-select multiple formControlName="RequireSubmitFields">

                                                        <ng-container *ngFor="let type of viewData.resumeRequireFields">

                                                            <mat-option value="{{ type }}">
                                                                {{ ('JOBS.OPTIONAL_FIELDS.' + type.toUpperCase()) | translate }}
                                                            </mat-option>

                                                        </ng-container>

                                                    </mat-select>

                                                    <mat-hint align="start">
                                                        {{ 'JOBS.HINTS.OPTIONAL_FIELDS' | translate }}
                                                    </mat-hint>

                                                </mat-form-field>

                                            </div>

                                        </div>

                                    </div>

                                </ng-container>

                            </m-portlet>

                        </div>

                    </div>

                    <div class="form-group m-form__group row">

                        <div class="col-xl-12 col-lg-12">

                            <m-portlet [options]="{theme: 'm-portlet--theme-gray-header'}">

                                <ng-container mPortletHeadTitle>

                                    <div class="m-portlet__head-title">
                                        <h3 class="m-portlet__head-text">
                                            <span>
                                                {{ 'JOBS.APPLIED_UNITS' | translate }}
                                            </span>
                                        </h3>
                                    </div>

                                </ng-container>

                                <ng-container mPortletBody>

                                    <div class="form-group m-form__group row">

                                        <div class="col-xl-12 col-lg-12 col-form-label">

                                            <mat-checkbox color="primary" formControlName="AllUnits">
                                                {{ 'FORM.FIELDS.ALL_UNITS' | translate }}</mat-checkbox>

                                        </div>

                                    </div>

                                    <div class="form-group m-form__group row" *ngIf="!form.get('AllUnits').value">

                                        <div class="col-xl-12 col-lg-12">

                                            <ng-container *ngIf="!form.get('AllUnits').value">

                                                <m-units-list-prototype [readonly]="false" [brandId]="viewData.brand.Id"
                                                    formControlName="Units">
                                                </m-units-list-prototype>

                                            </ng-container>

                                        </div>

                                    </div>

                                </ng-container>

                            </m-portlet>

                        </div>

                    </div>

                </div>

                <div class="col-lg-4 col-xl-4">

                    <m-job-embryo [formControl]="jobPreview"></m-job-embryo>

                </div>

            </div>

        </form>

    </ng-container>

</m-portlet>